---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE, 
  message = FALSE, 
  error = FALSE, 
  warning = FALSE,
  comment = "#>"
)
```


# climate-trace-br

## Aquisição dos dados

![](img/img-01.png)
![](img/img-02.png)
![](img/img-03.png)

![](img/img-04.png)
## Carregando Pacotes

```{r}
library(tidyverse)
library(geobr)
source("R/gafico.R")
```



## Mesclando base com ids

### Carregando as bases de dados

```{r}
brazil_ids <- read_rds("data/df_nome.rds")
emissions_sources <- read_rds("data/emissions_sources.rds")
```

```{r}
df_br <- brazil_ids %>% 
  select(nome,sigla_uf,nome_uf) %>%
  mutate(source_name = nome) %>%
  distinct(source_name,.keep_all = TRUE) %>% 
  relocate(source_name)

emissions_sources_brid <- left_join(emissions_sources,
                                    df_br,
                                    by = "source_name") %>% 
  relocate(source_name,nome,sigla_uf,nome_uf)
```

```{r}
emissions_sources_brid %>%
  filter(sigla_uf == "AC",
         sector_name == "agriculture",
         gas == "co2e_100yr",
         year == 2022
         ) %>%
  group_by(original_inventory_sector) %>%
  summarise( emission = sum(emissions_quantity,
                            na.rm = TRUE)) %>% 
  mutate(
    emission_cum = cumsum(emission)
  )
```
```{r}
states <- read_state(showProgress = FALSE)
states  %>% 
  ggplot() +
  geom_sf(fill="white", color="black",
          size=.15, show.legend = FALSE) +
  geom_point(
    data = emissions_sources_brid %>%
      filter(sigla_uf == "RJ",
             sector_name == "agriculture",
             gas == "co2e_100yr",
             year == 2022),
    aes(lon,lat)) +
  tema_mapa()
```

```{r}
# emissions_sources_brid %>%
#       filter(sigla_uf == "RJ",
#              sector_name == "agriculture",
#              gas == "co2e_100yr",
#              year == 2022) %>% 
#   arrange(lon)
```

